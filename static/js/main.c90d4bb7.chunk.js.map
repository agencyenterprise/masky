{"version":3,"sources":["assets/corona.svg","assets/health.svg","assets/logo.svg","components/About.tsx","components/GlobalStyle.tsx","lib/getDetectionStatus.ts","components/CustomThemeProvider.tsx","components/ArObjects.tsx","components/AudioIcon.tsx","components/Footer.tsx","lib/message.ts","components/PredictionWrapper.tsx","lib/useCanPlayAudio.ts","lib/useDetection.ts","lib/useWebcam.ts","components/Detector.tsx","lib/useDetectionModel.ts","lib/useAudio.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","year","Date","getFullYear","About","id","p","backgroundColor","color","variant","mb","mt","href","role","aria-label","justifyContent","alignItems","DetectionClass","GlobalStyle","styles","css","theme","colors","text","background","primary","secondary","muted","gray","noMask","yesMask","mixedMasks","highlight","fonts","body","heading","monospace","fontSizes","fontWeights","bold","lineHeights","space","sizes","avatar","radii","default","circle","shadows","card","fontFamily","lineHeight","fontWeight","display","fontSize","caps","textTransform","letterSpacing","variants","width","height","borderRadius","bg","boxShadow","link","nav","textDecoration","buttons","cursor","outline","root","CustomThemeProvider","children","DetectionColor","loading","face","mask","both","none","statusFromCounts","masks","faces","reducer","state","action","type","objects","filter","object","x","video","y","slice","map","dx","payload","dy","newArObjects","detections","newArObject","Error","ArObjects","videoRef","useReducer","dispatch","useDetections","useTick","useGenerateArObjects","useVideo","url","key","useEffect","handle","requestAnimationFrame","nextFrame","time","cancelAnimationFrame","setInterval","clearInterval","current","videoWidth","videoHeight","label","box","top","left","angle","Math","PI","random","cos","sin","uniqueId","corona","health","AudioIcon","audio","onChange","icon","EmptyButton","onClick","Footer","px","py","flex","textAlign","webcamStatusMessage","waiting","failed","connected","detectionMessage","PredictionWrapper","status","flexDirection","sx","position","initialState","storedValue","window","localStorage","getItem","warmUp","model","a","dummyImage","tf","detect","defaultVideoConstraints","facingMode","modelUrl","process","Detector","detectionModel","useState","setModel","automl","then","useDetectionModel","started","setStarted","videoConstraints","useRef","setStatus","navigator","mediaDevices","getUserMedia","stream","srcObject","console","error","catch","useWebcam","warmedUp","setWarmedUp","useWarmUp","setDetections","videoReady","setVideoReady","onVideoReady","useCallback","score","useDetection","canPlay","setCanPlay","setItem","toString","useCanPlayAudio","detectionStatus","forEach","detection","getDetectionStatus","src","playing","setAudio","Audio","play","pause","currentTime","useAudio","handleStart","playAudio","mr","logo","VideoContainer","Video","autoPlay","playsInline","ref","onLoadedData","SvgContainer","viewBox","ml","paddingY","webcamStatus","getMessage","hide","ButtonContainer","App","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.c90d4bb7.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/corona.95f04a28.svg\";","module.exports = __webpack_public_path__ + \"static/media/health.9599ae06.svg\";","module.exports = __webpack_public_path__ + \"static/media/logo.0a98c8a5.svg\";","import React, { FunctionComponent } from \"react\";\nimport { Heading, Text, Box, Flex, Link } from \"rebass\";\n\nconst year = new Date().getFullYear();\n\nexport const About: FunctionComponent = () => {\n  return (\n    <>\n      <Box id=\"about\" p={4} backgroundColor=\"primary\" color=\"secondary\">\n        <Heading variant=\"display\" mb={3}>\n          Doctor Masky is here to remind you, just put on a mask.\n        </Heading>\n\n        <Text variant=\"body\">\n          Like everyone else these days, our neural network is trained to\n          recognize faces in masks, and to watch out for faces without them.\n        </Text>\n\n        <Text variant=\"body\">\n          So take your mask off (when you're inside please!) and let the Doctor\n          show you what's <em>really</em> going on.\n        </Text>\n\n        <Heading variant=\"display\" mt={4}>\n          FAQ\n        </Heading>\n\n        <Heading variant=\"heading\" mt={3} mb={2}>\n          Are you stealing pictures of my face?!\n        </Heading>\n\n        <Text variant=\"body\">\n          We promise we're not. Your video stream never leaves your device, and\n          all the mask detecting is happing right there on your machine. Doctor\n          Masky is always with you.\n        </Text>\n\n        <Heading variant=\"heading\" mt={3} mb={2}>\n          How does it work?\n        </Heading>\n\n        <Text variant=\"body\">\n          If you want to get technical, we used{\" \"}\n          <Link href=\"https://cloud.google.com/automl\" color=\"secondary\">\n            Google AutoML Vision\n          </Link>{\" \"}\n          to train the model,{\" \"}\n          <Link href=\"https://www.tensorflow.org/js\" color=\"secondary\">\n            TensorFlow.js\n          </Link>{\" \"}\n          to run the inferences, and React to put it all together. You can read\n          more about how we built it in{\" \"}\n          <Link href=\"https://blog.ae.studio/doctor-masky/\" color=\"secondary\">\n            this blog post\n          </Link>\n          .\n        </Text>\n\n        <Text variant=\"body\">\n          If you don't want to get technical, then it's magic{\" \"}\n          <span role=\"img\" aria-label=\"sparkles\">\n            ✨\n          </span>\n        </Text>\n\n        <Heading variant=\"heading\" mt={3} mb={2}>\n          Okay this is cool I guess. What should I do with it?\n        </Heading>\n\n        <Text variant=\"body\">\n          Messing around with it (and listening to the soothing tones of Cardi\n          B) is enough for us. But if you own a store and you're having trouble\n          getting people to wear their masks, maybe set up a tablet and let\n          Doctor Masky play bad cop?\n          <br />\n          <br />\n          BTW if you do this, please{\" \"}\n          <Link href=\"mailto:info@ae.studio\" color=\"secondary\">\n            send us an email\n          </Link>{\" \"}\n          to tell us how it went!\n        </Text>\n\n        <Heading variant=\"heading\" mt={3} mb={2}>\n          This is taking a while to load.\n        </Heading>\n\n        <Text variant=\"body\">\n          Yeah it takes a few seconds to get going. Think of it like visiting\n          any other doctor, you're going to spend some time waiting.\n        </Text>\n\n        <Heading variant=\"heading\" mt={3} mb={2}>\n          Are viruses really shooting out of my mouth whenever I take my mask\n          off?\n        </Heading>\n\n        <Text variant=\"body\">Yes.</Text>\n\n        <Heading variant=\"heading\" mt={3} mb={2}>\n          Why did you make this?\n        </Heading>\n\n        <Text variant=\"body\">\n          We're AE Studio, and we care about increasing human agency. We know\n          you want to help protect people, and we think this is a fun way to\n          remind yourself to do it.\n        </Text>\n\n        <Text variant=\"body\">\n          Also, if you've got a human-agency increasing data science or\n          application development project, we'd love to{\" \"}\n          <Link href=\"https://ae.studio/#robot-here\" color=\"secondary\">\n            help you build it!\n          </Link>\n        </Text>\n      </Box>\n\n      <Flex\n        justifyContent=\"space-between\"\n        alignItems=\"center\"\n        backgroundColor=\"background\"\n        p={4}\n        color=\"primary\"\n      >\n        <Text variant=\"body\">© {year} AE Studio, all rights reserved</Text>\n\n        <Link href=\"mailto:info@ae.studio\">\n          <Text variant=\"body\">Contact</Text>\n        </Link>\n      </Flex>\n    </>\n  );\n};\n","/** @jsx jsx */\nimport { jsx, Global, css } from \"@emotion/core\";\n\nexport const GlobalStyle = () => {\n  return (\n    <Global\n      styles={css`\n        html,\n        body,\n        #root {\n          height: 100%;\n        }\n\n        body {\n          margin: 0;\n        }\n      `}\n    />\n  );\n};\n","import { PredictedObject } from \"@tensorflow/tfjs-automl\";\n\nexport const DETECTION_THRESHOLD = 0.65;\n\nexport enum DetectionClass {\n  face = \"b'face'\",\n  mask = \"b'mask'\",\n}\n\nexport type DetectionStatus = \"loading\" | \"none\" | \"face\" | \"mask\" | \"both\";\n\nexport const DetectionColor: Record<DetectionStatus, string> = {\n  loading: \"secondary\",\n  face: \"noMask\",\n  mask: \"yesMask\",\n  both: \"mixedMasks\",\n  none: \"secondary\",\n};\n\nexport const getDetectionStatus = (\n  detections: PredictedObject[] | null\n): DetectionStatus => {\n  if (!detections) {\n    return \"loading\";\n  }\n\n  let masks = 0;\n  let faces = 0;\n\n  detections.forEach((detection) => {\n    if (detection.label === DetectionClass.mask) {\n      masks += 1;\n    } else if (detection.label === DetectionClass.face) {\n      faces += 1;\n    }\n  });\n\n  return statusFromCounts(masks, faces);\n};\n\nconst statusFromCounts = (masks: number, faces: number): DetectionStatus => {\n  if (masks > 0 && faces > 0) {\n    return \"both\";\n  }\n  if (masks > 0) {\n    return \"mask\";\n  }\n  if (faces > 0) {\n    return \"face\";\n  }\n  return \"none\";\n};\n","/** @jsx jsx */\nimport { jsx } from \"@emotion/core\";\nimport { FunctionComponent } from \"react\";\nimport { ThemeProvider } from \"emotion-theming\";\n\nconst theme = {\n  colors: {\n    text: \"#000\",\n    background: \"#032B43\",\n    primary: \"#f9f9f9\",\n    secondary: \"#032B43\",\n    muted: \"#f6f6f9\",\n    gray: \"#dddddf\",\n    noMask: \"#D00000\",\n    yesMask: \"#136F63\",\n    mixedMasks: \"#ffba08\",\n    highlight: \"hsla(205, 100%, 40%, 0.125)\",\n  },\n  fonts: {\n    body: \"system-ui, sans-serif\",\n    heading: \"system-ui, sans-serif\",\n    monospace: \"Menlo, monospace\",\n  },\n  fontSizes: [12, 14, 16, 20, 24, 32, 48, 64, 96],\n  fontWeights: {\n    body: 400,\n    heading: 700,\n    bold: 700,\n  },\n  lineHeights: {\n    body: 1.5,\n    heading: 1.25,\n  },\n  space: [0, 4, 8, 16, 32, 64, 128, 256, 512],\n  sizes: {\n    avatar: 48,\n  },\n  radii: {\n    default: 4,\n    circle: 99999,\n  },\n  shadows: {\n    card: \"0 0 4px rgba(0, 0, 0, .125)\",\n  },\n  // rebass variants\n  text: {\n    heading: {\n      fontFamily: \"heading\",\n      lineHeight: \"heading\",\n      fontWeight: \"heading\",\n    },\n    display: {\n      fontFamily: \"heading\",\n      fontWeight: \"heading\",\n      lineHeight: \"heading\",\n      fontSize: [5, 6, 7],\n    },\n    body: {\n      fontFamily: \"body\",\n      fontWeight: \"body\",\n      lineHeight: \"body\",\n      fontSize: [1, 2, 3],\n    },\n    caps: {\n      textTransform: \"uppercase\",\n      letterSpacing: \"0.1em\",\n    },\n  },\n  variants: {\n    avatar: {\n      width: \"avatar\",\n      height: \"avatar\",\n      borderRadius: \"circle\",\n    },\n    card: {\n      p: 2,\n      bg: \"background\",\n      boxShadow: \"card\",\n    },\n    link: {\n      color: \"primary\",\n    },\n    nav: {\n      fontSize: 1,\n      fontWeight: \"bold\",\n      display: \"inline-block\",\n      p: 2,\n      color: \"inherit\",\n      textDecoration: \"none\",\n      \":hover,:focus,.active\": {\n        color: \"primary\",\n      },\n    },\n  },\n  buttons: {\n    primary: {\n      fontSize: 2,\n      fontWeight: \"bold\",\n      color: \"background\",\n      bg: \"primary\",\n      borderRadius: \"default\",\n      cursor: \"pointer\",\n      \"&:hover\": {\n        backgroundColor: \"gray\",\n      },\n    },\n    outline: {\n      variant: \"buttons.primary\",\n      color: \"primary\",\n      bg: \"transparent\",\n      boxShadow: \"inset 0 0 2px\",\n    },\n    secondary: {\n      variant: \"buttons.primary\",\n      color: \"background\",\n      bg: \"secondary\",\n    },\n  },\n  styles: {\n    root: {\n      fontFamily: \"body\",\n      fontWeight: \"body\",\n      lineHeight: \"body\",\n    },\n  },\n};\n\nexport const CustomThemeProvider: FunctionComponent = ({ children }) => {\n  return <ThemeProvider theme={theme}>{children}</ThemeProvider>;\n};\n","import React, {\n  FunctionComponent,\n  Reducer,\n  useEffect,\n  useReducer,\n} from \"react\";\nimport { PredictedObject } from \"@tensorflow/tfjs-automl\";\n\nimport corona from \"../assets/corona.svg\";\nimport health from \"../assets/health.svg\";\nimport { DetectionClass } from \"../lib/getDetectionStatus\";\n\ninterface ArObject {\n  id: number;\n  x: number;\n  y: number;\n  dx: number;\n  dy: number;\n  url: string;\n}\n\nexport interface ArObjectsProps {\n  detections: PredictedObject[];\n  videoRef: React.MutableRefObject<HTMLVideoElement | null>;\n}\n\ninterface ArObjectsState {\n  objects: ArObject[];\n  detections: PredictedObject[];\n  video: { height: number; width: number };\n}\n\ninterface VideoDimensions {\n  width: number;\n  height: number;\n}\n\ntype Action<Type extends string, Payload> = {\n  type: Type;\n  payload: Payload;\n};\n\ntype EmptyAction<Type extends string> = {\n  type: Type;\n};\n\ntype ArObjectsAction =\n  | Action<\"tick\", number>\n  | Action<\"detections\", PredictedObject[]>\n  | Action<\"video\", VideoDimensions>\n  | EmptyAction<\"generate\">;\n\nconst SPEED = 40;\nconst SPAWN_FREQUENCY = 1000 * 0.5;\nconst MAX_AR_OBJECTS = 20;\n\nconst reducer: Reducer<ArObjectsState, ArObjectsAction> = (state, action) => {\n  switch (action.type) {\n    case \"tick\": {\n      const objects = state.objects\n        .filter(\n          (object) =>\n            object.x > 0 &&\n            object.x < state.video.width &&\n            object.y > 0 &&\n            object.y < state.video.height\n        )\n        .slice(0, MAX_AR_OBJECTS)\n        .map((object) => ({\n          ...object,\n          x: object.x + object.dx * (1000 / action.payload),\n          y: object.y + object.dy * (1000 / action.payload),\n        }));\n      return { ...state, objects };\n    }\n    case \"video\": {\n      return { ...state, video: action.payload };\n    }\n    case \"generate\": {\n      const newArObjects = state.detections.map(newArObject);\n\n      return {\n        ...state,\n        objects: [...newArObjects, ...state.objects],\n      };\n    }\n    case \"detections\": {\n      return { ...state, detections: action.payload };\n    }\n    default:\n      throw new Error();\n  }\n};\n\nconst initialState = (): ArObjectsState => ({\n  objects: [],\n  detections: [],\n  video: {\n    width: 0,\n    height: 0,\n  },\n});\n\nexport const ArObjects: FunctionComponent<ArObjectsProps> = ({\n  detections,\n  videoRef,\n}) => {\n  const [state, dispatch] = useReducer(reducer, initialState());\n\n  useDetections(detections, dispatch);\n  useTick(dispatch);\n  useGenerateArObjects(dispatch);\n  useVideo(videoRef, dispatch);\n\n  const { objects } = state;\n\n  return (\n    <>\n      {objects.map(({ id, x, y, url }) => (\n        <image key={id} x={x} y={y} href={url} height={20} width={20} />\n      ))}\n    </>\n  );\n};\n\nconst useTick = (dispatch: React.Dispatch<ArObjectsAction>): void => {\n  useEffect(() => {\n    const nextFrame = (time: number) => {\n      dispatch({ type: \"tick\", payload: time });\n      requestAnimationFrame(nextFrame);\n    };\n\n    const handle = requestAnimationFrame(nextFrame);\n\n    return () => cancelAnimationFrame(handle);\n  }, [dispatch]);\n};\n\nconst useGenerateArObjects = (dispatch: React.Dispatch<ArObjectsAction>) => {\n  useEffect(() => {\n    const handle = setInterval(() => {\n      dispatch({ type: \"generate\" });\n    }, SPAWN_FREQUENCY);\n\n    return () => clearInterval(handle);\n  }, [dispatch]);\n};\n\nconst useDetections = (\n  detections: PredictedObject[],\n  dispatch: React.Dispatch<ArObjectsAction>\n): void => {\n  useEffect(() => {\n    dispatch({ type: \"detections\", payload: detections });\n  }, [detections, dispatch]);\n};\n\nconst useVideo = (\n  videoRef: React.MutableRefObject<HTMLVideoElement | null>,\n  dispatch: React.Dispatch<ArObjectsAction>\n) => {\n  const width = videoRef.current?.videoWidth || 0;\n  const height = videoRef.current?.videoHeight || 0;\n\n  useEffect(() => {\n    dispatch({ type: \"video\", payload: { width, height } });\n  }, [width, height, dispatch]);\n};\n\nconst newArObject = ({\n  label,\n  box: { top, left, height, width },\n}: PredictedObject): ArObject => {\n  if (label === DetectionClass.face) {\n    const angle = 2 * Math.PI * Math.random();\n    const dx = SPEED * Math.cos(angle);\n    const dy = SPEED * Math.sin(angle);\n\n    return {\n      id: uniqueId(),\n      url: corona,\n      x: left + width / 2,\n      y: top + height * (2 / 3),\n      dx,\n      dy,\n    };\n  } else {\n    return {\n      id: uniqueId(),\n      url: health,\n      x: left + width * Math.random(),\n      y: top - 10,\n      dx: 0,\n      dy: -SPEED,\n    };\n  }\n};\n\nexport const negativeOneToPositiveOne = () => {\n  const positive = Math.random() > 0.5;\n  return Math.random() * (positive ? 1 : -1);\n};\n\nlet id = 0;\nconst uniqueId = () => id++;\n","/** @jsx jsx */\nimport { jsx } from \"@emotion/core\";\nimport styled from \"@emotion/styled/macro\";\nimport { FunctionComponent } from \"react\";\nimport { Text } from \"rebass\";\n\nexport interface AudioIconProps {\n  audio: boolean;\n  onChange: (audio: boolean) => void;\n}\n\nexport const AudioIcon: FunctionComponent<AudioIconProps> = ({\n  audio,\n  onChange,\n}) => {\n  const label = audio ? \"audio on\" : \"muted\";\n  const icon = audio ? \"🔊\" : \"🔇\";\n  return (\n    <EmptyButton onClick={() => onChange(!audio)}>\n      <Text variant=\"body\">\n        <span role=\"img\" aria-label={label}>\n          {icon}\n        </span>\n      </Text>\n    </EmptyButton>\n  );\n};\n\nconst EmptyButton = styled.button`\n  position: fixed;\n  top: 1rem;\n  right: 1rem;\n  background: transparent;\n  border: none;\n`;\n","/** @jsx jsx */\nimport { jsx } from \"@emotion/core\";\nimport { FunctionComponent } from \"react\";\nimport { Flex, Box, Text, Link } from \"rebass\";\n\nexport const Footer: FunctionComponent = () => {\n  return (\n    <Flex justifyContent=\"space-between\" px={4} py={2}>\n      <Box flex=\"1 0 0\" />\n      <Box>\n        <Text color=\"primary\" textAlign=\"center\" variant=\"body\">\n          Made with{\" \"}\n          <span role=\"img\" aria-label=\"love\">\n            ❤️\n          </span>\n          &nbsp; by &nbsp;\n          <Link href=\"https://ae.studio\">AE Studio</Link>\n        </Text>\n      </Box>\n      <Box flex=\"1 0 0\">\n        <Link href=\"#about\">\n          <Text color=\"primary\" variant=\"body\" textAlign=\"right\">\n            About\n          </Text>\n        </Link>\n      </Box>\n    </Flex>\n  );\n};\n","import { ObjectDetectionModel } from \"@tensorflow/tfjs-automl\";\n\nimport { WebcamStatus } from \"./useWebcam\";\nimport { DetectionStatus } from \"./getDetectionStatus\";\n\nexport const webcamStatusMessage: Record<WebcamStatus, string> = {\n  waiting: \"Waiting for camera...\",\n  failed: \"Couldn't connect to camera. 😞\",\n  connected: \"\",\n};\n\nexport const detectionMessage: Record<DetectionStatus, string> = {\n  loading: \"Thinking...🤔\",\n  none: \"I'm not sure. Try getting closer to the screen. 🤔\",\n  both: \"Ask your friends to put on a mask! 😒\",\n  face: \"Don't forget your mask! 😱\",\n  mask: \"Thanks for wearing a mask! 👏\",\n};\n\nexport interface MessageStatuses {\n  model: ObjectDetectionModel | null;\n  detectionStatus: DetectionStatus;\n  webcamStatus: WebcamStatus;\n  started?: boolean;\n  warmedUp?: boolean;\n}\n\nexport const getMessage = ({\n  model,\n  detectionStatus,\n  webcamStatus,\n  started = true,\n  warmedUp = true,\n}: MessageStatuses): string => {\n  if (webcamStatus !== \"connected\") {\n    return webcamStatusMessage[webcamStatus];\n  } else if (!model) {\n    return \"Downloading model ⌛\";\n  } else if (!warmedUp) {\n    return \"🔥 Warming up the model 🔥\";\n  } else if (!started) {\n    return \"✨ Ready to start ✨\";\n  } else {\n    return detectionMessage[detectionStatus];\n  }\n};\n","/** @jsx jsx */\nimport { jsx } from \"@emotion/core\";\nimport { Flex } from \"rebass\";\nimport { FunctionComponent } from \"react\";\n\nimport { DetectionColor, DetectionStatus } from \"../lib/getDetectionStatus\";\n\nexport interface PredictionWrapperProps {\n  status: DetectionStatus;\n}\n\nexport const PredictionWrapper: FunctionComponent<PredictionWrapperProps> = ({\n  status,\n  children,\n}) => {\n  return (\n    <Flex\n      bg={DetectionColor[status]}\n      width=\"100%\"\n      height=\"100%\"\n      flexDirection=\"column\"\n      justifyContent=\"space-between\"\n      sx={{\n        position: \"relative\",\n      }}\n    >\n      {children}\n    </Flex>\n  );\n};\n","import { useState, useEffect } from \"react\";\n\nexport const useCanPlayAudio = (): [boolean, (canPlay: boolean) => void] => {\n  const [canPlay, setCanPlay] = useState(initialState);\n\n  useEffect(() => {\n    window.localStorage.setItem(\"canPlay\", canPlay.toString());\n  }, [canPlay]);\n\n  return [canPlay, setCanPlay];\n};\n\nconst initialState = () => {\n  const storedValue = window.localStorage.getItem(\"canPlay\");\n\n  if (!storedValue) return true;\n  return storedValue === \"true\" ? true : false;\n};\n","import React, { useState, useCallback, useEffect } from \"react\";\nimport * as tf from \"@tensorflow/tfjs\";\nimport * as automl from \"@tensorflow/tfjs-automl\";\n\nexport const DETECTION_INTERVAL = 500;\nexport const DETECTION_THRESHOLD = 0.45;\n\nexport type PredictedObjects = automl.PredictedObject[] | null;\n\nexport const useDetection = (\n  model: automl.ObjectDetectionModel | null,\n  videoRef: React.MutableRefObject<HTMLVideoElement | null>,\n  started = true\n): [PredictedObjects, () => void] => {\n  const [detections, setDetections] = useState<PredictedObjects>(null);\n  const [videoReady, setVideoReady] = useState(false);\n\n  const onVideoReady = useCallback(() => setVideoReady(true), [setVideoReady]);\n\n  // Start running detections after webcam is connected.\n  useEffect(() => {\n    const video = videoRef.current;\n    if (!started || !videoReady || !model || !video) return;\n\n    const detect = (video: HTMLVideoElement) =>\n      // Run the model, and ignore low-probability detections.\n      model.detect(video, { score: DETECTION_THRESHOLD });\n\n    // First run\n    detect(video).then(setDetections);\n\n    // Schedule detections.\n    const handle = setInterval(\n      () => detect(video).then(setDetections),\n      DETECTION_INTERVAL\n    );\n\n    // Clean up the interval if the useEffect is re-run.\n    return () => {\n      clearInterval(handle);\n    };\n  }, [started, videoReady, model, videoRef, setDetections]);\n\n  return [detections, onVideoReady];\n};\n\n/** Warm up the model after loading. */\nexport const useWarmUp = (model: automl.ObjectDetectionModel | null) => {\n  const [warmedUp, setWarmedUp] = useState(false);\n\n  // Warm up model while the camera is connecting.\n  useEffect(() => {\n    if (model) {\n      warmUp(model).then(() => setWarmedUp(true));\n    }\n  }, [model]);\n\n  return warmedUp;\n};\n\nconst warmUp = async (model: automl.ObjectDetectionModel): Promise<void> => {\n  const dummyImage = tf.zeros<tf.Rank.R3>([3, 3, 3]);\n  await model.detect(dummyImage);\n};\n","import { useRef, useEffect, useState } from \"react\";\n\nexport type WebcamStatus = \"waiting\" | \"connected\" | \"failed\";\n\nconst defaultVideoConstraints = { facingMode: \"user\" };\n\nexport const useWebcam = (\n  started = true,\n  videoConstraints: MediaTrackConstraints = defaultVideoConstraints\n): [React.MutableRefObject<HTMLVideoElement | null>, WebcamStatus] => {\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n  const [status, setStatus] = useState<WebcamStatus>(\"waiting\");\n\n  useEffect(() => {\n    if (!started) return;\n    navigator.mediaDevices\n      .getUserMedia({ video: videoConstraints })\n      .then((stream) => {\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          setStatus(\"connected\");\n        } else {\n          console.error(\"Webcam connected before video was ready.\");\n          setStatus(\"failed\");\n        }\n      })\n      .catch((error) => {\n        console.error(error);\n        setStatus(\"failed\");\n      });\n  }, [started, videoConstraints]);\n\n  return [videoRef, status];\n};\n","/** @jsx jsx */\nimport { jsx } from \"@emotion/core\";\nimport styled from \"@emotion/styled/macro\";\nimport { Box, Text, Flex, Image, Button } from \"rebass\";\nimport { FunctionComponent, useState } from \"react\";\n\nimport { ArObjects } from \"./ArObjects\";\nimport { AudioIcon } from \"./AudioIcon\";\nimport { getDetectionStatus } from \"../lib/getDetectionStatus\";\nimport { Footer } from \"./Footer\";\nimport { getMessage } from \"../lib/message\";\nimport { PredictionWrapper } from \"./PredictionWrapper\";\nimport { useAudio } from \"../lib/useAudio\";\nimport { useCanPlayAudio } from \"../lib/useCanPlayAudio\";\nimport { useDetection, useWarmUp } from \"../lib/useDetection\";\nimport { useDetectionModel } from \"../lib/useDetectionModel\";\nimport { useWebcam } from \"../lib/useWebcam\";\nimport logo from \"../assets/logo.svg\";\n\nconst modelUrl = `${process.env.REACT_APP_MODEL_URL}/model.json`;\n\nexport const Detector: FunctionComponent = () => {\n  const detectionModel = useDetectionModel(modelUrl);\n  const [started, setStarted] = useState(false);\n  const [videoRef, status] = useWebcam();\n  const warmedUp = useWarmUp(detectionModel);\n  const [detections, onVideoReady] = useDetection(\n    detectionModel,\n    videoRef,\n    started\n  );\n  const [canPlay, setCanPlay] = useCanPlayAudio();\n\n  const detectionStatus = getDetectionStatus(detections);\n\n  useAudio({\n    src: \"assets/coronavirus.mp3\",\n    playing: canPlay && detectionStatus === \"face\",\n    started,\n  });\n\n  const handleStart = (playAudio: boolean) => {\n    setCanPlay(playAudio);\n    setStarted(true);\n  };\n\n  return (\n    <PredictionWrapper status={detectionStatus}>\n      <AudioIcon audio={canPlay} onChange={setCanPlay} />\n\n      <Flex justifyContent=\"center\" alignItems=\"center\" p={2}>\n        <Image height={[40, 60, 80]} mr={3} src={logo} />\n        <Text color=\"primary\" textAlign=\"center\" variant=\"display\">\n          Doctor Masky\n        </Text>\n      </Flex>\n\n      <VideoContainer>\n        <Video\n          autoPlay\n          muted\n          playsInline\n          ref={videoRef}\n          onLoadedData={onVideoReady}\n        />\n\n        {videoRef.current && detections && (\n          <SvgContainer\n            viewBox={`0 0 ${videoRef.current?.videoWidth} ${videoRef.current?.videoHeight}`}\n          >\n            {started && (\n              <ArObjects detections={detections} videoRef={videoRef} />\n            )}\n          </SvgContainer>\n        )}\n\n        {!started && warmedUp && (\n          <ButtonContainer>\n            <Button variant=\"primary\" onClick={() => handleStart(true)}>\n              Start with sound\n            </Button>\n\n            <Button variant=\"primary\" onClick={() => handleStart(false)} ml=\"2\">\n              Start without sound\n            </Button>\n          </ButtonContainer>\n        )}\n      </VideoContainer>\n\n      <Box>\n        <Text\n          fontSize={[3, 4, 5]}\n          color=\"primary\"\n          textAlign=\"center\"\n          variant=\"heading\"\n          paddingY={3}\n        >\n          {getMessage({\n            model: detectionModel,\n            detectionStatus,\n            webcamStatus: status,\n            started,\n            warmedUp,\n          })}\n        </Text>\n\n        <Footer />\n      </Box>\n    </PredictionWrapper>\n  );\n};\n\nconst VideoContainer = styled.div`\n  position: relative;\n  flex-grow: 1;\n  flex-shrink: 1;\n`;\n\nconst Video = styled.video<{ hide?: boolean }>`\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  transform: scaleX(-1);\n  flex-grow: 1;\n  display: ${({ hide }) => (hide ? \"none\" : \"block\")};\n`;\n\nconst SvgContainer = styled.svg`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  transform: scaleX(-1);\n`;\n\nconst ButtonContainer: FunctionComponent = ({ children }) => {\n  return (\n    <Flex\n      width=\"100%\"\n      height=\"100%\"\n      justifyContent=\"center\"\n      alignItems=\"center\"\n      sx={{\n        top: \"0\",\n        left: \"0\",\n        position: \"absolute\",\n      }}\n    >\n      {children}\n    </Flex>\n  );\n};\n","import { useState, useEffect } from \"react\";\nimport * as automl from \"@tensorflow/tfjs-automl\";\n\nexport const useDetectionModel = (\n  modelUrl: string\n): automl.ObjectDetectionModel | null => {\n  const [model, setModel] = useState<automl.ObjectDetectionModel | null>(null);\n\n  useEffect(() => {\n    automl.loadObjectDetection(modelUrl).then(setModel);\n  }, [modelUrl]);\n\n  return model;\n};\n","import { useEffect, useState } from \"react\";\n\nexport interface UseAudioProps {\n  src: string;\n  playing: boolean;\n  started: boolean;\n}\n\nexport const useAudio = ({ src, playing, started }: UseAudioProps) => {\n  const [audio, setAudio] = useState<HTMLAudioElement | null>(null);\n\n  useEffect(() => {\n    if (started) {\n      setAudio(new Audio(src));\n    }\n  }, [started, src]);\n\n  useEffect(() => {\n    if (!audio) return;\n\n    if (playing) {\n      audio.play();\n    } else {\n      audio.pause();\n      audio.currentTime = 0;\n    }\n  }, [audio, playing]);\n};\n","import React from \"react\";\n\nimport { About } from \"./components/About\";\nimport { GlobalStyle } from \"./components/GlobalStyle\";\nimport { CustomThemeProvider } from \"./components/CustomThemeProvider\";\nimport { Detector } from \"./components/Detector\";\n// import { App as Detector } from \"./components/BlogDetector\";\n\nexport const App: React.FunctionComponent = () => {\n  return (\n    <CustomThemeProvider>\n      <GlobalStyle />\n      <Detector />\n      <About />\n    </CustomThemeProvider>\n  );\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { App } from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}